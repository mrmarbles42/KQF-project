data = fruit_data_wide)
m_9 <- lme4::lmer(log_rot ~ temp_9 + precip_9 + (1 | bog),
data = fruit_data_wide)
#NLME----
m_10 <- lme4::lmer(log_rot ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
m_11 <- lme4::lmer(log_rot ~ temp_11 + precip_11 + (1 | bog),
data = fruit_data_wide)
m_12 <- lme4::lmer(log_rot ~ temp_12 + precip_12 + (1 | bog),
data = fruit_data_wide)
m_12 <- lme4::lmer(log_rot ~ temp_12 + precip_12 + (1 | bog),
data = fruit_data_wide)
fruit_data_wide %>%
nest(-grower)
grow_nest <- fruit_data_wide %>%
nest(-grower)
View(grow_nest)
View(grow_nest[[2]][[94]])
vis_dat(grow_nest)
View(grow_nest[[2]][[91]])
grow_nest <- fruit_data_wide %>%
nest(-grower, -bog)
View(grow_nest)
View(grow_nest)
View(grow_nest[[3]][[5]])
grow_nest <- fruit_data_wide %>%
nest(-grower)
View(grow_nest)
View(grow_nest)
View(grow_nest[[2]][[70]])
View(grow_nest[[2]][[56]])
View(grow_nest[[2]][[56]])
View(grow_nest[[2]][[56]])
View(grow_nest[[2]][[56]])
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_analysis.R", echo=TRUE)
summary(m_9)
m_12 <- lme4::lmer(log_rot ~ temp_12 + precip_12 + (1 | variety),
data = fruit_data_wide)
m_12 <- lme4::lmer(log_rot ~ temp_12 + precip_12 + (1 | bog),
data = fruit_data_wide)
m_12 <- lme4::lmer(log_rot ~ temp_12 + precip_12 ,
data = fruit_data_wide)
summary(m_10)
summary(m_11)
#rot by kqf
kqf_data_wide %>%
group_by(final_points) %>%
mutate(mean_rot = mean(rot_pct)) %>%
ggplot(aes(factor(final_points), rot_pct)) +
geom_point()
#rot by kqf
fruit_data_wide %>%
group_by(final_points) %>%
mutate(mean_rot = mean(rot_pct)) %>%
ggplot(aes(factor(final_points), rot_pct)) +
geom_point()
#rot by kqf
fruit_data_wide %>%
group_by(final_points) %>%
mutate(mean_rot = mean(rot_pct)) %>%
droplevels(as.factor(.$final_points)) %>%
ggplot(aes(factor(final_points), rot_pct)) +
geom_point()
#source(here("code", "kqf_clean.R"))
source(here("code", "kqf_analysis.R"))
nlme_coef <- read_csv(here("data", "kqf_nlme_coef - Sheet1.csv"))
View(nlme_coef)
nlme_coef %>%
ggplot(aes(month, temp)) + geom_point()
ggplot(aes(month, abs(temp)) +
nlme_coef %>%
ggplot(aes(month, abs(temp))) +
geom_point() +
scale_y_continuous()
nlme_coef %>%
nlme_coef %>%
ggplot(aes(month, abs(temp))) +
geom_point()
nlme_coef %>%
ggplot(aes(month, abs(as.numeric(temp)))) +
geom_point()
nlme_coef %>%
ggplot(aes(month %in% c(9,10,11), abs(as.numeric(temp)))) +
geom_point()
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_point()
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_point() +
scale_y_continuous(labels = 0:10)
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_point() +
scale_y_continuous(labels = 0.0:10.0)
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_point() +
scale_y_continuous(labels = 0.0:10.0)
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_point() +
scale_y_continuous(labels = month)
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_point() +
scale_y_continuous(labels = precip)
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_point() +
scale_y_continuous(labels = scale(precip))
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_point()
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_bar()
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_plots.R", echo=TRUE)
nlme_coef %>%
ggplot(aes(month, precip)) +
geom_line()
nlme_coef %>%
group_by(month) %>%
ggplot(aes(month, precip)) +
geom_line()
nlme_coef %>%
group_by(month) %>%
ggplot(aes(month, precip)) +
geom_line() +
geom_point()
nlme_coef %>%
group_by(month) %>%
ggplot(aes(month, precip)) +
geom_point() +
geom_line()
nlme_coef %>%
group_by(month) %>%
ggplot(aes(month, precip)) +
geom_point()
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(month, precip)) +
geom_point()
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point()
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
ylim(-10,10)
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), as.numeric(precip))) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), as.numeric(precip))) +
geom_point()
+
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
kqf_data_combined %>%
filter(rot_pct != 0 & data_source == "decas") %>%
ggplot(aes(log_rot)) +
geom_freqpoly()
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), as.numeric(precip))) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), as.numeric(precip))) +
stat_count() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
ggplot(aes(as.factor(month), as.numeric(precip)) +
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), as.numeric(precip))) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
sdf
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), as.numeric(precip))) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
fruit_data_wide %>%
nest(-variety)
fruit_data_wide %>%
group_by(bog,grower)
fruit_data_wide %>%
group_by(bog)
1-pt(abs(-0.474), df = 30)
1-pt(abs(-0.474), df = 300)
1-pt(abs(-1.796), df = 30)
1-pt(abs(1.09), df = 30)
1-pt(abs(6.807), df = 30)
1-pt(abs(-8.425), df = 30)
1-pt(abs(-3.268), df = 30)
1-pt(abs(-1.796), df = 300)
summary(m_10)
1-pt(abs(-1.796), df = 2313)
1-pt(abs(-1.796), df = 398)
1-pt(abs(-1.796), df = 2312)
lme4::lmer(log_rot ~ temp_3 + precip_3 + (1 | bog),
data = fruit_data_wide)
lme4::lmer(log_rot ~ temp_12 + precip_12 + (1 | bog),
data = fruit_data_wide)
nlme_coef <- read_csv(here("data", "kqf_nlme_coef - Sheet1.csv"))
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_plots.R", echo=TRUE)
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), as.numeric(precip))) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef <- read_csv(here("data", "kqf_nlme_coef - Sheet1.csv"))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), as.numeric(precip))) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), abs(as.numeric(precip)))) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef$temp <- abs(as.numeric(nlme_coef$temp))
View(nlme_coef)
nlme_coef$precip <- abs(as.numeric(nlme_coef$precip))
ggplot(aes(as.factor(month), precip) +
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
a
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(precip)) +
geom_bar() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(precip)) +
geom_bar() +
scale_y_continuous(limits = c(-10,10), breaks = c(0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(precip)) +
geom_bar()
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(precip, color = temp)) +
geom_bar()
as.factor(month),
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_linne() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_line() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_smooth() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(-10,10), breaks = c(-10, -5, 0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(0,10), breaks = c(0, 5, 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(0,10), breaks = c(0, (sum(precip)/3), 10))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(0,10), breaks = c(min(precip) -1, (sum(precip)/3), max(precip) + 1))
ab2 <- lme4::lmer(log_rot ~ temp_1 + precip_1 + variety +(1 | bog),
data = fruit_data_wide)
#pt_10_variety
ab2 <- lme4::lmer(log_rot ~ temp_1 + precip_1 + (1 | bog),
data = fruit_data_wide)
grow_nest <- fruit_data_wide %>%
nest(-grower)
View(grow_nest)
View(grow_nest[[2]][[3]])
summary(m_10)
summary(m_11)
summary(m_9
summary(m_9)
summary(m_9)
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(0,10), breaks = c(min(precip) -0.1, (sum(precip)/3), max(precip) + 0.1))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(0,10), breaks = c(0, (sum(precip)/3), 10))
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
# fruit_decas)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(fruit_decas)
levels(fruit_decas$month)
levels(as.factor(fruit_decas$month))
require(here)
#source(here("code", "kqf_clean.R"))
source(here("code", "kqf_analysis.R"))
nlme_coef %>%
filter(month %in% c(9,10,11)) %>%
ggplot(aes(as.factor(month), precip)) +
geom_point() +
scale_y_continuous(limits = c(0,10), breaks = c(0, (sum(precip)/3), 10))
summary(m_9)
summary(m_10)
summary(m_11)
View(fruit_data_wide)
View(temp_precip)
levels(as.factor(temp_precip))
#climate parameters 2003-2020----
#data import
temp_precip <- fread(here("data/base_files", "kqf_temp_precip.csv"))
View(temp_precip)
fruit_data_wide %>%
q''
View(fruit_data_wide)
filter(month = 10, year = 2006)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(fruit_decas)
glimpse(fruit_decas)
fruit_data_wide %>%
ggplot(aes(year)) +
geom_boxplot()
View(fruit_decas)
fruit_data_wide %>%
ggplot(aes(year, temp_10)) +
geom_boxplot()
fruit_data_wide %>%
ggplot(aes(as.factor(year), temp_10)) +
geom_boxplot()
fruit_data_wide %>%
filter(year %in% 2012:2018)
fruit_data_wide %>%
filter(year %in% 2012:2018) %>%
ggplot(aes(as.factor(year), temp_10)) +
geom_boxplot()
fruit_data_wide %>%
filter(year %in% 2012:2018) %>%
ggplot(aes(as.factor(year), temp_11)) +
geom_boxplot()
summary(m_9)
summary(m_10)
summary(m_11)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_analysis.R", echo=TRUE)
summary(m_9)
summary(m_10)
summary(m_11)
View(m_9)
View(m_11)
hist(resid(m_9))
hist(resid(m_10))
hist(resid(m_11))
qqnorm(resid(m_10))
qqnorm(resid(m_11))
qqnorm(resid(m_9))
plot(resid(m_10), predict())
plot(resid(m_10), predict(m_10))
plot(resid(m_11), predict(m_11))
plot(resid(m_9), predict(m_9))
ls()
a <- data.frame([c(1,2,3,4)])
12l
12L
class(12.123)
source("C:/Users/User/OneDrive - University of Massachusetts/kqf_project/code/kqf_analysis.R", echo=TRUE)
11 <- lme4::lmer(log_rot ~ temp_11 + precip_11 + (1 | bog),
data = fruit_data_wide)
m_11 <- lme4::lmer(log_rot ~ temp_11 + precip_11 + (1 | bog),
data = fruit_data_wide)
source(here("code", "kqf_clean.R"))
source("C:/Users/User/OneDrive - University of Massachusetts/kqf_project/code/kqf_analysis.R", echo=TRUE)
m_11 <- lme4::lmer(log_rot ~ temp_11 + precip_11 + (1 | bog),
data = fruit_data_wide)
summary(m_11)
(m_9)
summary(m_9)
summary(m_10)
summary(m_10)
summary(m_11)
qq()
qqline(m_10)
qqnorm(m_1-)
qqnorm(m_10)
class(m_10)
m_10
m_11
fruit_data_wide %>%
group_by(bog) %>%
filter(is.na(temp_9) == F) %>%
summarize(max = max(temp_9),
min = min(temp_9),
mean = mean(temp_9),
median = median(temp_9),
n = n()) %>%
arrange(bog, .by_group = T)
fitted(m_10)
(1 - pt(abs(x), df = y))
t_val <- function(x, y = 30) {
(1 - pt(abs(x), df = y))
}
t_val(-8.607, 171)
p_val <- function(x, y = 30) {
(1 - pt(abs(x), df = y))
}
#color vis
fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
ggplot(aes(variety, log_rot)) +
geom_boxplot(aes(color = variety))
#color vis
fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
ggplot(aes(factor(variety), log_rot)) +
geom_boxplot(aes(color = variety))
#color vis
fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
droplevels(.$variety) %>%
ggplot(aes(factor(variety), log_rot)) +
geom_boxplot(aes(color = variety))
library(here)
library(lme4)
library(GGally)
library(broom)
source(here("code", "kqf_clean.R"))
nest(-grower)
fruit_data_wide %>%
group_by(bog)
nest(-grower)
nest(-grower, - bog)
nest(-grower, -bog)
fruit_data_wide %>%
group_by(bog)
nest(-grower, -bog)
fruit_data_wide %>%
group_by(bog, grower)
fruit_data_wide %>%
group_by(bog, grower) %>%
nest()
View(fruit_data_wide)
m9_resid <- resid(m_9)
#NLME model & diagnostics----
m_9 <- lme4::lmer(log_rot ~ temp_9 + precip_9 + (1 | bog),
data = fruit_data_wide)
m9_resid <- resid(m_9)
m10_resid <- resid(m_10)
m11_resid <- resid(m_11)
m_10 <- lme4::lmer(log_rot ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
m_11 <- lme4::lmer(log_rot ~ temp_11 + precip_11 + (1 | bog),
data = fruit_data_wide)
m11_resid <- resid(m_11)
m10_resid <- resid(m_10)
m11_resid <- resid(m_11)
m9_fit <- fitted(m_9)
m10_fit <- fitted(m_10)
m11_fit <- fitted(m_11)
hist(m9_resid)
hist(m9_fit)
hist(m9_fit)
hist(m10_resid)
hist(m10_fit)
hist(m11_fit)
hist(m11_resid)
plot(m10_fit, m10_resid)
plot(m9_fit, m9_resid)
plot(m11_fit, m11_resid)
plot(m10_fit, m10_resid) #fitted values vs residuals
plot(m11_fit, m11_resid)
