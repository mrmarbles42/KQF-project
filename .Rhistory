library(lme4)
library(GGally)
source(here("code", "kqf_clean.R"))
lme4::lmer(rot_pct ~ temp_10 + (precip_10 | year),
data = fruit_data_wide)
lme4::lmer(rot_pct ~ temp_10 + (precip_10 || year),
data = fruit_data_wide)
lme4::lmer(rot_pct ~ temp_10 + (1 || year),
data = fruit_data_wide)
lme4::lmer(rot_pct ~ temp_10 + (1 | year),
data = fruit_data_wide)
View(fruit_data_wide)
lme4::lmer(rot_pct ~ precip_10 + (1 | year),
data = fruit_data_wide)
lme4::lmer(log_rot ~ precip_10 + (1 | year),
data = fruit_data_wide)
lme4::lmer( log_rot ~ temp_10 + precip_10 +(1 | variety),
data = fruit_data_wide)
lme4::lmer( log_rot ~ temp_10 + precip_10 +(1 | bog),
data = fruit_data_combined)
lme4::lmer( log_rot ~ temp_10 + precip_10 +(1 | bog),
data = fruit_data_wide)
lme4::lmer(log_rot ~ temp_10 + precip_10 +(1 | year),
data = fruit_data_wide)
lme4::lmer(log_rot ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
lme4::lmer(log_rot ~ temp_10 + precip_10 +(1 | variety),
data = fruit_data_wide)
lme4::lmer(log_rot ~ precip_10 + (1 | year),
data = fruit_data_wide)
lme4::lmer(log_rot ~ precip_10 + (1 | year),
data = fruit_data_wide)
lme4::lmer(log_rot ~ precip_9 + (1 | year),
data = fruit_data_wide)
pre_10_year <- lme4::lmer(log_rot ~ precip_10 + (1 | year),
data = fruit_data_wide)
pre_10_year$coefficients
pre_10_year
View(pre_10_year)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
gc()
precip_10_year <- lme4::lmer(log_rot ~ precip_10 + (1 | year),
data = fruit_data_wide)
precip_9_year <- lme4::lmer(log_rot ~ precip_9 + (1 | year),
data = fruit_data_wide)
pt_10_variety <- lme4::lmer(log_rot ~ temp_10 + precip_10 +(1 | variety),
data = fruit_data_wide)
precip_9_year
pt_10_bog <- lme4::lmer(log_rot ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
pt_10_year <- lme4::lmer(log_rot ~ temp_10 + precip_10 +(1 | year),
data = fruit_data_wide)
#temperature by temporals w/ precip g/month as RE
lme4::lmer(avg_temp_f ~ month + year + (tot_precip | month),
data = fruit_data_combined)
precip_9_year <- lme4::lmer(log_rot ~ precip_9 + (1 | year),
data = fruit_data_wide)
View(precip_9_year)
precip_9_year
pt_10_bog
lme4::lmer(rot_pct ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
lme4::lmer(log_rot ~ temp_10 + precip_10 +(1 | variety),
data = fruit_data_wide)
#pt_9_bog
lme4::lmer(log_rot ~ temp_9 + precip_9 + (1 | bog),
data = fruit_data_wide)
lme4::lmer(log_rot ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
#temperature by temporals w/ precip g/month as RE
lme4::lmer(avg_temp_f ~ month + year + (1 | month),
data = fruit_data_wie)
#temperature by temporals w/ precip g/month as RE
lme4::lmer(avg_temp_f ~ month + year + (1 | month),
data = fruit_data_wide)
rm(fruit_data_unique)
rm(fruit_data_unique,
pest_data_combined)
install.packages("ggThemeAssist")
install.packages("equisse")
install.packages("esquisse")
install.packages("quiestionr")
install.packages("questionr")
esquisse:::esquisser()
ggThemeAssist:::ggThemeAssistAddin()
library(here)
library(lme4)
library(GGally)
source(here("code", "kqf_clean.R"))
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_analysis.R", echo=TRUE)
#
#average rot percentage by variety
rot_by_variety <- fruit_data_wide %>%
group_by(variety) %>%
summarize(mean = mean(rot_pct, na.rm = T))
View(rot_by_variety)
fruit_data_wide %>%
filter(is.na(rot_pct) == F) %>%
group_by(variety) %>%
summarize(mean = mean(rot_pct, na.rm = T))
fruit_data_wide %>%
group_by(variety) %>%
summarize(mean = mean(rot_pct, na.rm = T))
fruit_data_wide %>%
filter(is.na(rot_pct) == F) %>%
group_by(variety) %>%
summarize(mean = mean(rot_pct, na.rm = T))
fruit_data_combined %>%
group_by(variety) %>%
summarize(mean = mean(rot_pct,
na.rm = T)) %>%
arrange(desc(mean), .by_group = T)
#
fruit_data_wide %>%
group_by(variety) %>%
summarize(mean = mean(rot_pct,
na.rm = T)) %>%
arrange(desc(mean), .by_group = T)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_analysis.R", echo=TRUE)
#rot_pct vis
fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
ggplot(aes(as.factor(final_points), rot_pct)) +
geom_point() +
geom_jitter()
#log_rot vis
logrot_vs_kqf <- fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
ggplot(aes(as.factor(final_points), log_rot)) +
geom_jitter() +
geom_point()
logrot_vs_kqf
#log_rot vis
logrot_vs_kqf <- fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
ggplot(aes(as.factor(final_points), log_rot)) +
geom_jitter() +
geom_boxplot()
logrot_vs_kqf
#log_rot vis
logrot_vs_kqf <- fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
ggplot(aes(as.factor(final_points), log_rot)) +
geom_boxplot() +
geom_jitter()
logrot_vs_kqf
#rot_pct vis
fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
ggplot(aes(as.factor(final_points), rot_pct)) +
geom_point()
#log_rot vis
logrot_vs_kqf <- fruit_data_wide %>%
filter(is.na(final_points) == F) %>%
ggplot(aes(as.factor(final_points), log_rot)) +
geom_jitter() +
geom_boxplot()
ggpairs(fruit_data_wide)
combined
fruit_data_combined %>%
ggplot(aes(log_rot)) +
geom_histogram(bins = 10) +
facet_wrap(~final_points)
fruit_data_wide %>%
ggplot(aes(log_rot)) +
geom_histogram(bins = 10) +
facet_wrap(~final_points)
shapiro.test(fruit_data_wide$log_rot)
shapiro.test(fruit_data_wide$final_points)
shapiro.test(fruit_data_wide$rot_pct)
shapiro.test(fruit_data_wide$temp_10)
hist(fruit_data_wide$temp_10)
hist(fruit_data_wide$temp_10, bins = 30)
hist(fruit_data_wide$temp_10, breaks = 30)
hist(fruit_data_wide$temp_10, breaks = 10)
hist(fruit_data_wide$temp_10, breaks = 5)
hist(fruit_data_wide$temp_10, breaks = 8)
View(fruit_data_wide)
#pt 10 bog
lme4::lmer(log_rot ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
#pt 10 bog
lme4::lmer(rot_pct ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
hist(resid(lme4::lmer(log_rot ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)))
hist(resid(lme4::lmer(rot_pct ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)))
pt_10_bog <- lme4::lmer(log_rot ~ temp_10 + precip_10 + (1 | bog),
data = fruit_data_wide)
qqnorm(resid(pt_10_bog))
qqline(resid(pt_10_bog))
predict(pt_10_bog)
plot(predict(pt_10_bog), resid(pt_10_bog))
summary(pt_10_bog)
View(fruit_data_wide)
# %>%
#   #select for desired fields
#   select(date, year,
#          grower, bog, variety,
#          color, rot_pct, log_rot,
#          pre_points, final_points,
#          temp_9, temp_10, temp_11, temp_12,
#          precip_9, precip_10, precip_11, precip_12)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(fruit_data_wide)
fruit_data_wide <- fruit_data_unique %>%
#filter NA/month/year
filter(is.na(date) != T,
month %in% c(3,4,5,6,7,8,9,10,11,12),
year %in% c(2013,2014,2015,2016,2017,2018)) %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
rm(
pest_data_combined)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
fruit_data_wide <- fruit_data_unique %>%
#filter NA/month/year
filter(is.na(date) != T,
month %in% c(3,4,5,6,7,8,9,10,11,12),
year %in% c(2013,2014,2015,2016,2017,2018)) %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
fruit_data_wide <- fruit_data_unique %>%
filter(is.na(date) != T,
month %in% c(3,4,5,6,7,8,9,10,11,12),
year %in% c(2013,2014,2015,2016,2017,2018))
fruit_data_wide <- fruit_data_unique %>%
#filter NA/month/year
filter(is.na(date) != T,
month %in% c(3,4,5,6,7,8,9,10,11,12),
year %in% c(2013,2014,2015,2016,2017,2018)) %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
fruit_data_wide <- fruit_data_unique %>%
#filter NA/month/year
filter(is.na(date) != T,
month %in% c(3,4,5,6,7,8,9,10,11,12),
year %in% c(2013,2014,2015,2016,2017,2018)) %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
fruit_data_wide <- fruit_data_unique %>%
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
fruit_data_wide <- fruit_data_unique %>%
#filter NA/month/year
filter(is.na(date) != T,
month %in% c(3,4,5,6,7,8,9,10,11,12),
year %in% c(2013,2014,2015,2016,2017,2018)) %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
pt_10_bog
summary(pt_10_bog)
ab1 <- summary(pt_10_bog)
ab1$coefficients
pt(-7, df = 30)
1 - pt(abs(-7), df = 30)
hist(fruit_data_wide$temp_10)
glimpse(fruit_data_wide)
lme4::lmer(log_rot ~ temp_10 + precip_10 +(1 | variety),
data = fruit_data_wide)
table(fruit_data_wide$variety)
lme4::lmer(log_rot ~ temp_10 + precip_10 + variety +(1 | bog),
data = fruit_data_wide)
summary(lme4::lmer(log_rot ~ temp_10 + precip_10 + variety +(1 | bog),
data = fruit_data_wide))
#pt_10_variety
ab2 <- lme4::lmer(log_rot ~ temp_10 + precip_10 + variety +(1 | bog),
data = fruit_data_wide)
resid(ab2)
hist(resid(lme4::lmer(log_rot ~ temp_10 + precip_10 + variety +(1 | bog),
data = fruit_data_wide)))
plot(predict(ab2), resid(ab2))
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(fruit_data_unique)
rm(fruit_data_unique,
fruit_data_combined)
View(temp_precip)
temp_precip$month_2 <- temp_precip$month
temp_precip %>%
pivot_wider(names_from = month,)
temp_precip %>%
pivot_wider(names_from = month,
values_from = avg_temp_f)
temp_precip <- temp_precip %>%
pivot_wider(names_from = month,
values_from = avg_temp_f)
temp_precip %>%
select(year %in% c(2013:2018))
temp_precip %>%
filter(year %in% c(2013:2018))
temp_precip_13-18 <- temp_precip %>%
filter(year %in% c(2013:2018))
temp_precip_13_18 <- temp_precip %>%
filter(year %in% c(2013:2018))
View(temp_precip)
temp_precip_12_18 <- temp_precip %>%
filter(year %in% c(2013:2018))
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
fruit_data_unique <- fruit_data_combined %>%
unique()
View(fruit_data_wide)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(fruit_data_wide)
fruit_data_wide <- fruit_data_unique %>%
filter(is.na(date) != T,
month %in% c(3,4,5,6,7,8,9,10,11,12),
year %in% c(2013,2014,2015,2016,2017,2018))
View(fruit_data_wide)
fruit_data_wide <- fruit_data_unique %>%
#filter NA/month/year
filter(is.na(date) != T,
month %in% c(3,4,5,6,7,8,9,10,11,12),
year %in% c(2013,2014,2015,2016,2017,2018)) %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
View(fruit_data_wide)
View(temp_precip_13_18)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
rm(temp_precip_13_18)
rm(temp_precip)
View(temp_precip_12_18)
temp_precip <- temp_precip %>%
mutate(month = lubridate::month(date),
year = lubridate::year(date)) %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
source(here("code", "kqf_import.R"))
temp_precip <- temp_precip %>%
mutate(month = lubridate::month(date),
year = lubridate::year(date)) %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
temp_precip$month_2 <- temp_precip$month
temp_precip %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
temp_rpecip <- temp_precip %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
View(temp_rpecip)
temp_precip <- temp_precip %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(pest_data_combined)
vis_dat(pest_data_combined)
vis_dat(pest_data_combined, warn_large_data = F)
duplicated(pest_data_combined)
unique(pest_data_combined)
pest_data_unique <- unique(pest_data_combined)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
temp_precip <- temp_precip %>%
#temperature pivot
pivot_wider(names_from =  month,
names_prefix = "temp_",
values_from = avg_temp_f) %>%
#precipitation pivot
pivot_wider(names_from = month_2,
names_prefix = "precip_",
values_from = tot_precip)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
gc()
gc()
gc()
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(fruit_data_wide)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
temp_precip$month_2 <- temp_precip$month
View(temp_precip)
temp_precip <- temp_precip %>%
mutate(month = lubridate::month(date),
year = lubridate::year(date)) %>%
#filter for years of interest
filter(year %in% c(2013:2018))
View(temp_precip)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(fruit_data_wide)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
View(fruit_data_unique)
source("C:/Users/user/OneDrive - University of Massachusetts/kqf_project/code/kqf_clean.R", echo=TRUE)
gc()
#Decas fruit data 2013-2018----
##date manipulation
fruit_decas$date <- parse_date_time(fruit_decas$date, "mdy")
source(here("code", "kqf_import.R"))
fruit_decas <- fruit_decas %>%
##exclude rows w/ NA values in rot
filter(is.na(rot_pct) == F) %>%
##create log_rot / year / month columns and collapse varieties by frequency
mutate(
log_rot = log10(rot_pct + 1) ,
variety = fct_collapse(variety, other = other_varieties),
year = lubridate::year(date),
month = lubridate::month(date),
##create data_source column
data_source = as.factor("decas")
) %>%
##relocate date column to [,1]
relocate(date)
other_varieties = c("OE","ORST","OH",
"OM","GR","OB",
"SN","MC","SK",
"ORHO","OS","MX",
"GD","PD")
source(here("code", "kqf_import.R"))
##date manipulation
fruit_decas$date <- parse_date_time(fruit_decas$date, "mdy")
fruit_decas <- fruit_decas %>%
##exclude rows w/ NA values in rot
filter(is.na(rot_pct) == F) %>%
##create log_rot / year / month columns and collapse varieties by frequency
mutate(
log_rot = log10(rot_pct + 1) ,
variety = fct_collapse(variety, other = other_varieties),
year = lubridate::year(date),
month = lubridate::month(date),
##create data_source column
data_source = as.factor("decas")
) %>%
##relocate date column to [,1]
relocate(date)
other_varieties = c("OE","ORST","OH",
"OM","GR","OB",
"SN","MC","SK",
"ORHO","OS","MX",
"GD","PD")
fruit_decas <- fruit_decas %>%
##exclude rows w/ NA values in rot
filter(is.na(rot_pct) == F) %>%
##create log_rot / year / month columns and collapse varieties by frequency
mutate(
log_rot = log10(rot_pct + 1) ,
variety = fct_collapse(variety, other = other_varieties),
year = lubridate::year(date),
month = lubridate::month(date),
##create data_source column
data_source = as.factor("decas")
) %>%
##relocate date column to [,1]
relocate(date)
View(fruit_decas)
